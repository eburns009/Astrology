<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Astrology Chart</title>
  <style>
    body { font-family: sans-serif; margin: 20px; }
    .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin: 10px 0; }
    input, select { padding: 8px; }
    button { padding: 10px 20px; margin: 5px; }
  </style>
</head>
<body>
  <h1>Astrology Chart</h1>
  
  <form method="GET" action="/chart">
    <div class="form-row">
      <div>
        <label>Name:</label>
        <input name="person" value="{{ data.person if data else '' }}">
      </div>
      <div>
        <label>Birthplace:</label>
        <input name="place" value="{{ data.place if data else '' }}">
      </div>
    </div>
    
    <div class="form-row">
      <div>
        <label>Date & Time:</label>
        <input type="datetime-local" name="dt" value="{{ default_dt }}">
      </div>
      <div>
        <label>Timezone:</label>
        <select name="tz">
          <option value="auto">Auto</option>
          <option value="UTC">UTC</option>
        </select>
      </div>
    </div>
    
    <div class="form-row">
      <div>
        <label>Zodiac:</label>
        <select name="zodiac">
          <option value="tropical" {% if not data or data.zodiac == 'Tropical' %}selected{% endif %}>Tropical</option>
          <option value="sidereal_fb" {% if data and data.zodiac == 'Sidereal (Fagan-Bradley)' %}selected{% endif %}>Sidereal (Fagan-Bradley)</option>
        </select>
      </div>
      <div>
        <label>Frame:</label>
        <select name="frame">
          <option value="geo">Geocentric</option>
          <option value="helio">Heliocentric</option>
        </select>
      </div>
    </div>
    
    <div>
      <button type="submit">Calculate Chart</button>
      <button type="button" onclick="window.location.reload()">New Chart</button>
    </div>
  </form>

  {% if data %}
  <h2>Results</h2>
  <p><strong>{{ data.person or 'Chart' }}</strong> - {{ data.place }} - {{ data.zodiac }}</p>
  {% if data.ayanamsa > 0 %}
  <p>Ayanamsa: {{ "%.2f"|format(data.ayanamsa) }}Â°</p>
  {% endif %}
  
  <table border="1" style="margin: 20px 0;">
    <tr><th>Planet</th><th>Position</th></tr>
    {% for row in data.table %}
    <tr><td>{{ row.name }}</td><td>{{ row.lon_fmt }}</td></tr>
    {% endfor %}
  </table>
  {% endif %}
</body>
</html>
